// ==================== 通用样式占位符 ====================
%flex-column {
  display: flex;
  flex-direction: column;
}

%flex-full {
  flex: 1;
  overflow: hidden;
}

%disabled-base {
  opacity: 0.6;
  color: #999 !important;
}

%disabled-strikethrough {
  @extend %disabled-base;
  text-decoration: line-through;
}

%disabled-tag {
  @extend %disabled-base;
  filter: grayscale(50%);
  
  :deep(.n-tag__content) {
    text-decoration: line-through;
  }
}

%disabled-card {
  opacity: 0.7;
  background-color: #fafafa;
  
  :deep(.n-card__header) {
    background-color: #f0f0f0;
  }
}

%content-card {
  @extend %flex-column;
  height: 100%;

  :deep(.n-card__content) {
    @extend %flex-column, %flex-full;
  }
}

// ==================== 主容器样式 ====================
.role-management {
  @extend %flex-column;
  padding: 16px;
  height: calc(100vh - 120px);
  gap: 16px;

  .main-content {
    @extend %flex-full;
    min-height: 0;
  }

  .content-card {
    @extend %content-card;
  }

  // ==================== 角色表格样式 ====================
  :deep(.n-data-table) {
    .n-data-table-td {
      padding: 12px 8px;
    }

    .n-data-table-th {
      background-color: var(--n-color-hover);
    }

    // 禁用行样式
    .disabled-row {
      background-color: #fafafa !important;
      opacity: 0.7;

      &:hover {
        background-color: #f0f0f0 !important;
      }

      td {
        background-color: transparent !important;
      }
    }

    // 操作列不换行
    .n-data-table-td:last-child {
      .n-space {
        flex-wrap: nowrap !important;
      }
    }
  }

  // ==================== 禁用状态通用样式 ====================
  .disabled-text {
    @extend %disabled-strikethrough;
  }

  .disabled-tag {
    @extend %disabled-tag;
  }

  // ==================== 角色详情样式 ====================
  .role-detail {
    padding: 16px;
    position: relative;

    .disabled-card {
      @extend %disabled-card;
    }

    .disabled-text {
      @extend %disabled-strikethrough;
    }

    .disabled-tag {
      @extend %disabled-tag;
    }
  }

  // ==================== 权限分配样式 ====================
  .permission-assignment {
    border: 1px solid var(--n-border-color);
    border-radius: 6px;
    overflow: hidden;

    .permission-toolbar {
      padding: 12px;
      background-color: var(--n-color-hover);
      border-bottom: 1px solid var(--n-border-color);
    }

    .permission-content {
      display: flex;
      height: 400px;

      .permission-tree-section,
      .selected-permissions-section {
        flex: 1;
        display: flex;
        flex-direction: column;
        border-right: 1px solid var(--n-border-color);

        &:last-child {
          border-right: none;
        }
      }

      .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px;
        background-color: var(--n-color-hover);
        border-bottom: 1px solid var(--n-border-color);
      }

      .permission-tree-container {
        flex: 1;
        overflow: hidden;
        padding: 8px;
      }

      .selected-permissions-container {
        flex: 1;
        overflow-y: auto;
        padding: 8px;

        .empty-permissions {
          height: 100%;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 8px;
        }

        .selected-permissions-list {
          .permission-group {
            margin-bottom: 16px;
            border: 1px solid var(--n-border-color);
            border-radius: 6px;
            overflow: hidden;

            .group-header {
              display: flex;
              align-items: center;
              gap: 8px;
              padding: 8px 12px;
              background-color: var(--n-color-hover);
              border-bottom: 1px solid var(--n-border-color);
            }

            .group-permissions {
              padding: 12px;
              display: flex;
              flex-wrap: wrap;
              gap: 8px;
            }
          }
        }
      }
    }
  }

  // ==================== 权限模板样式 ====================
  .permission-templates {
    .template-selected {
      border-color: var(--n-color-primary);
      background-color: var(--n-color-primary-suppl);
    }
  }

  // ==================== 权限树样式 ====================
  :deep(.n-tree) {
    .n-tree-node-content {
      padding: 8px;
      border-radius: 4px;
      
      &:hover {
        background-color: var(--n-color-hover);
      }
    }

    .n-tree-node-content--selected {
      background-color: var(--n-color-primary-suppl);
    }
  }

  // ==================== 响应式设计 ====================
  @media (max-width: 768px) {
    .permission-content {
      flex-direction: column;
      height: auto;
      
      .permission-tree-section,
      .selected-permissions-section {
        border-right: none;
        border-bottom: 1px solid var(--n-border-color);
        min-height: 200px;

        &:last-child {
          border-bottom: none;
        }
      }
    }
  }
}